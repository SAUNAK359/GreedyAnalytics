FROM python:3.12-slim

ENV PYTHONDONTWRITEBYTECODE=1 \
	PYTHONUNBUFFERED=1 \
	API_URL=http://api:8000

WORKDIR /app

RUN useradd -m appuser

COPY frontend/ /app/analytics_llm/frontend/
COPY __init__.py /app/analytics_llm/__init__.py
COPY requirements.txt /app/analytics_llm/requirements.txt

RUN pip install --no-cache-dir -r /app/analytics_llm/requirements.txt

USER appuser

EXPOSE 8501

CMD ["streamlit", "run", "analytics_llm/frontend/app.py", "--server.port", "8501", "--server.address", "0.0.0.0"]
